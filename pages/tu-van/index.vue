<template>
  <div class="min-h-screen bg-black text-white">
    <!-- Hero Section -->
    <section class="hero-gradient py-16 md:py-24 relative overflow-hidden">
      <div class="absolute inset-0 bg-black/20"></div>
      <div class="relative z-10 container mx-auto px-4 text-center">
        <div class="mb-6">
          <i class="fas fa-dumbbell text-red-500 text-6xl mb-4"></i>
        </div>
        <h1
          class="text-5xl md:text-7xl font-extrabold mb-6 text-transparent bg-clip-text bg-gradient-to-r from-white to-red-500"
        >
          AI T∆∞ v·∫•n Fitness
        </h1>
        <p class="text-xl md:text-2xl text-gray-300 mb-8 max-w-2xl mx-auto">
          C√¥ng ngh·ªá AI th√¥ng minh gi√∫p b·∫°n ƒë·∫°t m·ª•c ti√™u th·ªÉ h√¨nh nhanh ch√≥ng v√†
          hi·ªáu qu·∫£
        </p>
        <div class="flex justify-center gap-8 text-sm text-gray-400">
          <div class="flex items-center gap-2">
            <i class="fas fa-check-circle text-green-500"></i>
            <span>T∆∞ v·∫•n c√° nh√¢n h√≥a</span>
          </div>
          <div class="flex items-center gap-2">
            <i class="fas fa-chart-line text-blue-500"></i>
            <span>K·∫ø ho·∫°ch khoa h·ªçc</span>
          </div>
          <div class="flex items-center gap-2">
            <i class="fas fa-users text-purple-500"></i>
            <span>H·ªó tr·ª£ 24/7</span>
          </div>
        </div>
      </div>
    </section>

    <!-- Form Section -->
    <section class="py-12 px-4">
      <div class="container mx-auto max-w-4xl">
        <div class="card bg-base-100 shadow-2xl">
          <div class="card-body">
            <h2 class="card-title text-3xl justify-center mb-8 text-primary">
              <i class="fas fa-clipboard-list mr-3"></i>
              Th√¥ng tin c·ªßa b·∫°n
            </h2>

            <form id="consultForm" class="grid md:grid-cols-2 gap-6">
              <div class="form-control">
                <label class="label">
                  <span class="label-text font-semibold">
                    <i class="fas fa-user mr-2 text-primary"></i>H·ªç v√† t√™n
                  </span>
                </label>
                <input
                  name="name"
                  type="text"
                  placeholder="Nh·∫≠p h·ªç t√™n c·ªßa b·∫°n"
                  class="input input-bordered input-primary"
                  required
                />
              </div>

              <div class="form-control">
                <label class="label">
                  <span class="label-text font-semibold">
                    <i class="fas fa-venus-mars mr-2 text-primary"></i>Gi·ªõi t√≠nh
                  </span>
                </label>
                <select
                  name="gender"
                  class="select select-bordered select-primary"
                  required
                >
                  <option value="" disabled selected>Ch·ªçn gi·ªõi t√≠nh</option>
                  <option value="Nam">Nam</option>
                  <option value="N·ªØ">N·ªØ</option>
                </select>
              </div>

              <div class="form-control">
                <label class="label">
                  <span class="label-text font-semibold">
                    <i class="fas fa-birthday-cake mr-2 text-primary"></i>Tu·ªïi
                  </span>
                </label>
                <input
                  name="age"
                  type="number"
                  placeholder="Nh·∫≠p tu·ªïi c·ªßa b·∫°n"
                  class="input input-bordered input-primary"
                  min="1"
                  max="100"
                  required
                />
              </div>

              <div class="form-control">
                <label class="label">
                  <span class="label-text font-semibold">
                    <i class="fas fa-ruler-vertical mr-2 text-primary"></i>Chi·ªÅu
                    cao (cm)
                  </span>
                </label>
                <input
                  name="height"
                  type="number"
                  placeholder="V√≠ d·ª•: 170"
                  class="input input-bordered input-primary"
                  min="100"
                  max="250"
                  required
                />
              </div>

              <div class="form-control">
                <label class="label">
                  <span class="label-text font-semibold">
                    <i class="fas fa-weight mr-2 text-primary"></i>C√¢n n·∫∑ng (kg)
                  </span>
                </label>
                <input
                  name="weight"
                  type="number"
                  placeholder="V√≠ d·ª•: 65"
                  class="input input-bordered input-primary"
                  min="30"
                  max="200"
                  required
                />
              </div>

              <div class="form-control">
                <label class="label">
                  <span class="label-text font-semibold">
                    <i class="fas fa-calendar-week mr-2 text-primary"></i>S·ªë
                    bu·ªïi t·∫≠p/tu·∫ßn
                  </span>
                </label>
                <input
                  name="weekly_sessions"
                  type="number"
                  placeholder="V√≠ d·ª•: 3"
                  class="input input-bordered input-primary"
                  min="1"
                  max="7"
                  required
                />
              </div>

              <div class="form-control md:col-span-2">
                <label class="label">
                  <span class="label-text font-semibold">
                    <i class="fas fa-target mr-2 text-primary"></i>M·ª•c ti√™u t·∫≠p
                    luy·ªán
                  </span>
                </label>
                <input
                  name="goal"
                  type="text"
                  placeholder="V√≠ d·ª•: Gi·∫£m m·ª° b·ª•ng, tƒÉng c∆° to√†n th√¢n, c·∫£i thi·ªán s·ª©c kh·ªèe..."
                  class="input input-bordered input-primary"
                  required
                />
              </div>

              <div class="form-control">
                <label class="label">
                  <span class="label-text font-semibold">
                    <i class="fas fa-clock mr-2 text-primary"></i>Th·ªùi gian mong
                    mu·ªën
                  </span>
                </label>
                <input
                  name="goal_time"
                  type="text"
                  placeholder="V√≠ d·ª•: 3 th√°ng, 6 th√°ng..."
                  class="input input-bordered input-primary"
                  required
                />
              </div>

              <div class="form-control">
                <label class="label">
                  <span class="label-text font-semibold">
                    <i class="fas fa-activity mr-2 text-primary"></i>M·ª©c ƒë·ªô v·∫≠n
                    ƒë·ªông
                  </span>
                </label>
                <select
                  name="activity_level"
                  class="select select-bordered select-primary"
                  required
                >
                  <option value="" disabled selected>
                    Ch·ªçn m·ª©c ƒë·ªô v·∫≠n ƒë·ªông
                  </option>
                  <option value="Th·∫•p">Th·∫•p - √çt v·∫≠n ƒë·ªông</option>
                  <option value="Trung b√¨nh">
                    Trung b√¨nh - V·∫≠n ƒë·ªông ƒë·ªÅu ƒë·∫∑n
                  </option>
                  <option value="Cao">Cao - V·∫≠n ƒë·ªông nhi·ªÅu</option>
                </select>
              </div>

              <div class="md:col-span-2 mt-6">
                <button
                  type="submit"
                  class="btn btn-primary btn-lg w-full text-white font-bold"
                >
                  <span id="buttonText">
                    <i class="fas fa-brain mr-2"></i>
                    Nh·∫≠n t∆∞ v·∫•n t·ª´ AI
                  </span>
                  <span id="loadingSpinner" class="hidden">
                    <div class="loading-spinner mr-2"></div>
                    AI ƒëang ph√¢n t√≠ch...
                  </span>
                </button>
              </div>
            </form>
          </div>
        </div>

        <!-- Results Section -->
        <div id="resultsSection" class="hidden mt-8 fade-in">
          <div class="card bg-base-100 shadow-2xl">
            <div class="card-body">
              <h2 class="card-title text-3xl justify-center mb-8 text-success">
                <i class="fas fa-check-circle mr-3"></i>
                K·∫øt qu·∫£ t∆∞ v·∫•n
              </h2>
              <div id="resultsContent"></div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </div>
</template>

<script>
document
  .getElementById("consultForm")
  .addEventListener("submit", async function (e) {
    e.preventDefault();

    // Show loading state
    const buttonText = document.getElementById("buttonText");
    const loadingSpinner = document.getElementById("loadingSpinner");
    const submitButton = e.target.querySelector('button[type="submit"]');

    buttonText.classList.add("hidden");
    loadingSpinner.classList.remove("hidden");
    submitButton.disabled = true;

    // Hide previous results
    document.getElementById("resultsSection").classList.add("hidden");

    // Collect form data
    const formData = new FormData(e.target);
    const data = Object.fromEntries(formData.entries());

    try {
      // Simulate API call (replace with actual API endpoint)
      const response = await fetch("/api/consult", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify(data),
      });

      const result = await response.json();
      displayResults(result.message);
    } catch (error) {
      console.error("Error:", error);
      // Display mock result for demo
      const mockResult = `**üìä 1. ƒê√ÅNH GI√Å TH·ªÇ TR·∫†NG HI·ªÜN T·∫†I:**
BMI c·ªßa b·∫°n: 22.5 (B√¨nh th∆∞·ªùng)
Th·ªÉ tr·∫°ng hi·ªán t·∫°i ·ªü m·ª©c trung b√¨nh, ph√π h·ª£p ƒë·ªÉ b·∫Øt ƒë·∫ßu ch∆∞∆°ng tr√¨nh t·∫≠p luy·ªán.

**üéØ 2. PH√ÇN T√çCH M·ª§C TI√äU:**
V·ªõi 3 bu·ªïi t·∫≠p/tu·∫ßn, b·∫°n c√≥ th·ªÉ ƒë·∫°t m·ª•c ti√™u gi·∫£m 5kg trong 3-4 th√°ng.
M·ª•c ti√™u n√†y ho√†n to√†n kh·∫£ thi v·ªõi k·∫ø ho·∫°ch ph√π h·ª£p.

**üí™ 3. L·ªäCH T·∫¨P ƒê·ªÄ XU·∫§T:**
- Th·ª© 2: Cardio + B√†i t·∫≠p to√†n th√¢n
- Th·ª© 4: T·∫≠p t·∫° + Yoga
- Th·ª© 6: HIIT + Stretching

**ü•ó 4. CH·ªÇ ƒê·ªò DINH D∆Ø·ª†NG:**
- ƒÇn nhi·ªÅu: Protein, rau xanh, tr√°i c√¢y
- H·∫°n ch·∫ø: ƒê·ªì chi√™n r√°n, ƒë·ªì ng·ªçt
- U·ªëng ƒë·ªß 2-3 l√≠t n∆∞·ªõc/ng√†y

**üåü 5. L·ªúI KHUY√äN:**
Ki√™n tr√¨ l√† ch√¨a kh√≥a th√†nh c√¥ng! H√£y b·∫Øt ƒë·∫ßu t·ª´ t·ª´ v√† tƒÉng c∆∞·ªùng ƒë·ªô d·∫ßn d·∫ßn.

**üéÅ G·ª¢I √ù G√ìI T·∫¨P:**
G√≥i Slim Fit - 3 bu·ªïi/tu·∫ßn, ph√π h·ª£p v·ªõi m·ª•c ti√™u gi·∫£m c√¢n c·ªßa b·∫°n.

**üë®‚Äçüè´ HU·∫§N LUY·ªÜN VI√äN ƒê·ªÄ XU·∫§T:**
PT Linh - Chuy√™n v·ªÅ gi·∫£m c√¢n, h·ªó tr·ª£ t√¢m l√Ω t·ªët, ph√π h·ª£p v·ªõi ng∆∞·ªùi m·ªõi b·∫Øt ƒë·∫ßu.`;

      displayResults(mockResult);
    } finally {
      // Reset button state
      buttonText.classList.remove("hidden");
      loadingSpinner.classList.add("hidden");
      submitButton.disabled = false;
    }
  });

function displayResults(resultText) {
  const resultsContent = document.getElementById("resultsContent");
  const resultsSection = document.getElementById("resultsSection");

  // Parse and format the result
  const sections = parseResultSections(resultText);

  resultsContent.innerHTML = sections
    .map(
      (section, index) => `
                <div class="result-card rounded-lg p-6 mb-6">
                    <div class="flex items-start gap-4">
                        <div class="section-icon w-12 h-12 rounded-full flex items-center justify-center flex-shrink-0">
                            <i class="fas ${getSectionIcon(
                              index
                            )} text-white text-lg"></i>
                        </div>
                        <div class="flex-1">
                            <h3 class="text-xl font-bold mb-3 text-white">${
                              section.title
                            }</h3>
                            <div class="text-gray-300 leading-relaxed">${
                              section.content
                            }</div>
                        </div>
                    </div>
                </div>
            `
    )
    .join("");

  resultsSection.classList.remove("hidden");
  resultsSection.scrollIntoView({ behavior: "smooth" });
}

function parseResultSections(text) {
  const sections = [];
  const lines = text.split("\n");
  let currentSection = null;

  for (const line of lines) {
    if (line.includes("**") && line.includes(":")) {
      if (currentSection) {
        sections.push(currentSection);
      }
      currentSection = {
        title: line.replace(/\*\*/g, "").trim(),
        content: "",
      };
    } else if (currentSection && line.trim()) {
      currentSection.content += line + "<br>";
    }
  }

  if (currentSection) {
    sections.push(currentSection);
  }

  return sections;
}

function getSectionIcon(index) {
  const icons = [
    "fa-heartbeat", // ƒê√°nh gi√° th·ªÉ tr·∫°ng
    "fa-bullseye", // Ph√¢n t√≠ch m·ª•c ti√™u
    "fa-calendar-alt", // L·ªãch t·∫≠p
    "fa-apple-alt", // Dinh d∆∞·ª°ng
    "fa-star", // L·ªùi khuy√™n
    "fa-gift", // G√≥i t·∫≠p
  ];
  return icons[index] || "fa-info-circle";
}
</script>
<style scoped>
.hero-gradient {
  background: linear-gradient(
    135deg,
    #0f0f23 0%,
    #1a0a2e 25%,
    #16213e 50%,
    #0f3460 75%,
    #533a71 100%
  );
}
.loading-spinner {
  border: 3px solid #f3f3f3;
  border-top: 3px solid #ef4444;
  border-radius: 50%;
  width: 24px;
  height: 24px;
  animation: spin 1s linear infinite;
}
@keyframes spin {
  0% {
    transform: rotate(0deg);
  }
  100% {
    transform: rotate(360deg);
  }
}
.fade-in {
  animation: fadeIn 0.8s ease-in-out;
}
@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}
.result-card {
  background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
  border: 1px solid #475569;
}
.section-icon {
  background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
}
</style>
